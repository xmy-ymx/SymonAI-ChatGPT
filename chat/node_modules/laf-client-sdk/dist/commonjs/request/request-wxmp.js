"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const types_1 = require("../types");
const request_1 = require("./request");
/**
 * 微信小程序环境请求类
 */
class WxmpRequest extends request_1.Request {
    constructor(config) {
        super(config);
    }
    /**
     * 微信小程序环境请求方法
     * @override
     * @param data
     * @returns
     */
    async request(url, data, _options) {
        var _a;
        if (this.options.environment !== types_1.EnvironmentType.WX_MP) {
            throw new Error('environment type must be wxmp');
        }
        const token = this.options.getAccessToken();
        const header = this.getHeaders(token);
        const options = {
            url,
            header,
            method: (_a = _options === null || _options === void 0 ? void 0 : _options.method) !== null && _a !== void 0 ? _a : 'POST',
            data,
            dataType: 'json'
        };
        return new Promise((resolve, reject) => {
            wx.request(Object.assign(Object.assign({}, options), { success(res) {
                    resolve(res);
                },
                fail(err) {
                    reject(err);
                } }));
        });
    }
}
exports.WxmpRequest = WxmpRequest;
//# sourceMappingURL=request-wxmp.js.map